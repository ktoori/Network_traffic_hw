# Salary Regression Model

Данный проект реализует обучение и использование **регрессионной модели** для предсказания зарплат на основе заранее обработанного датасета hh.csv.

Модель обучается на NumPy-массивах, полученных на этапе предобработки данных:
* `x_data.npy` — матрица признаков (результат пайплайна)
* `y_data.npy` — целевая переменная (зарплаты в рублях)

После обучения модель сохраняется в папку `resources/` и используется для инференса через CLI-интерфейс.

## Структура проекта

### `hh_salary_model/`

Пакет с основной логикой проекта.

* **`__init__.py`**  
  Инициализация пакета.

* **`io_utils.py`**  
  Утилиты для загрузки и валидации входных данных.
  * проверка существования файлов
  * проверка размерностей массивов
  * приведение типов к `float64`
  * контроль `NaN` и бесконечных значений

* **`metrics.py`**  
  Реализация стандартных метрик качества регрессии:
  * MAE
  * MSE
  * RMSE
  * R²

* **`model.py`**  
  Обёртка над моделями `scikit-learn` для регрессии зарплат. Реализует:
  * линейную регрессию без регуляризации (`penalty="none"`)
  * Ridge-регрессию (L2, `penalty="l2"`)
  * Lasso-регрессию (L1, `penalty="l1"`)
  * масштабирование признаков с помощью `RobustScaler`
  * опциональную логарифмическую трансформацию целевой переменной (`log1p`)
  * сохранение и загрузку обученной модели в формате `joblib`

### `resources/`

Папка для хранения артефактов модели.

* **`model.joblib`** — сохранённая обученная модель вместе с параметрами препроцессинга.


### Скрипты в корне проекта

* **`grid_train.py`** — основной скрипт обучения модели:
  * загружает `x_data.npy` и `y_data.npy`
  * выполняет разбиение `train_test_split`
  * перебирает тип регуляризации (`none`, `l1`, `l2`) и значения `alpha`
  * выбирает лучшую конфигурацию по метрике RMSE на тестовой выборке
  * дообучает лучшую модель на всех данных
  * сохраняет итоговую модель в `resources/model.joblib`

* **`app.py`** — CLI-приложение для инференса:
  * загружает модель из `resources/model.joblib`
  * принимает путь к `x_data.npy`
  * печатает предсказания в stdout

## Обучение модели

Для обучения необходимо передать файлы `x_data.npy` и `y_data.npy`, полученные на предыдущем этапе пайплайна.

Команда запуска обучения: `python grid_train.py path/to/x_data.npy path/to/y_data.npy`

После выполнения команды в папке `resources/` будет создан или обновлён файл `model.joblib`.


## Использование модели (инференс)

Интерфейс приложения: `python app.py path/to/x_data.npy`

На вход подаётся NumPy-файл с признаками.

## Формат вывода

`app.py` печатает результат в стандартный поток вывода (stdout):

* JSON-список
* значения типа `float`
* зарплаты в рублях
* порядок соответствует строкам входного массива

