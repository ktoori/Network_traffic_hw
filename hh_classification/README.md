# HH Level PoC: junior / middle / senior по данным резюме hh.ru

PoC-проект: по признакам резюме (возраст, город, опыт, готовность к переезду/командировкам, занятость/график, образование и др.) автоматически предсказать уровень разработчика: **junior / middle / senior**.

Проект сделан как небольшой эксперимент, чтобы показать жизнеспособность идеи.

---

## Что сделано

1. В hh_pipeline сохраняется x_data в формате csv для сохранения названий колонок. Далее идёт работа с ним.

2. Подготовлен датасет :
   - оставлены только резюме **IT-направления** (`IT_направление == 1`);
   - построена целевая переменная `level` по **названию должности** (one-hot колонки `Последняя должность_*`, `Ищет работу на должность_*`) и/или по **стажу** (`Стаж (месяцев)`).

3. Построены графики баланса классов в `artifacts/`:
   - `class_balance_bar.png`
   - `class_balance_pie.png`
   - `class_balance.txt`

4. Подготовлены признаки для обучения без утечки:
   - удалены признаки, по которым размечался уровень (например, `Последняя должность_*`, `Ищет работу на должность_*`);
   - удалены шумные признаки `Последнее место работы_*`.

4. Обучены классификаторы (Logistic Regression) и построены отчёты:
   - baseline
   - `class_weight="balanced"`
   - oversampling на train

---

## Артефакты

### `artifacts/` (датасет и баланс классов)
- `X_clean.csv` — очищенные признаки без утечки
- `y_level.csv` — целевая переменная (`junior/middle/senior`)
- `df_with_level.csv` — контрольный датасет со столбцом `level`
- `class_balance_bar.png` — баланс классов (bar)
- `class_balance_pie.png` — баланс классов (pie)
- `class_balance.txt` — текстовая сводка распределения

### `artifacts_model/` (модели и метрики)
- `metrics_summary.csv` — сводная таблица метрик по экспериментам
- для каждого эксперимента:  
  `classification_report.txt`, `confusion_matrix.png`

---

## Результаты (PoC)

Сводка по экспериментам:

| Эксперимент | Accuracy | F1 macro | F1 weighted |
|---|---:|---:|---:|
| baseline | 0.9777 | 0.9596 | 0.9777 |
| class_weight_balanced | 0.9645 | 0.9458 | 0.9655 |
| oversample_train | 0.9700 | 0.9532 | 0.9707 |

Интерпретация:
- **baseline** показывает максимальную accuracy и высокий macro-F1.
- при сильном дисбалансе классов важно смотреть **macro-F1** и метрики по каждому классу.
- **class_weight="balanced"** повышает чувствительность к меньшинствам (например, middle/junior), но снижает точность по большинству (senior), поэтому общая accuracy падает.
- **oversampling** даёт компромисс: macro-F1 выше, чем у class_weight, и accuracy выше, чем у class_weight, при этом recall меньшинств остаётся высоким.

---

## Выводы о качестве и причинах ошибок

1. **Идея жизнеспособна**: по данным hh.ru можно различать уровни junior/middle/senior с высоким качеством (macro-F1 около 0.95–0.96).
2. **Дисбаланс классов** влияет на интерпретацию качества:
   - accuracy может быть “обманчивой” и переоценивать качество на большинстве (senior).
   - корректнее использовать macro-F1 и per-class recall/precision.
3. **Качество разметки**:
   - уровень определяется эвристически (по должности/стажу), возможны ошибки:
     - “ведущий” в названии не всегда означает senior;
     - стаж не всегда отражает реальный уровень;
     - резюме могут быть заполнены неполно или неточно.
4. **Причины ошибок модели**:
   - пересечения профилей: часть middle близка к senior по стажу/образованию, а junior иногда имеет “сильные” признаки (высшее образование, стаж и т.п.);
5. **Балансировка**:
   - `class_weight="balanced"` и oversampling улучшают качество на меньшинствах, но меняют баланс ошибок (часто ценой точности по большинству).

---

## Установка и запуск

### 1) Создание окружения
```bash
python -m venv .venv
.venv\\Scripts\\activate
```

### 2) Установка зависимостей
```bash
pip install -r requirements.txt
```

### 3) Подготовка датасета (X_clean и y_level + графики)
```bash
python -m src.level_prepare.prepare_dataset path/to/x_data.csv --out-dir artifacts  
```

### 4) Обучение моделей и отчёты
```bash
python -m src.modeling.run_experiments --artifacts-dir artifacts --out-dir artifacts_model
```

---

## Структура проекта
- src/ - Исходный код (пакет)
   - io_utils.py — чтение/сохранение CSV
   - logging_utils.py - Настройка логирования (сообщения на русском)
   - level_prepare/ - Подготовка датасета для классификации
      - constants.py - Константы подготовки (колонки, префиксы, regex)
      - level_labeling.py - Разметка y_level по должности и стажу
      - feature_cleaning.py - Очистка X от утечек (должности/места работы)
      - plotting.py - Графики баланса классов
      - prepare_dataset.py - CLI-скрипт: готовит artifacts/ (X_clean, y_level, графики)
   - modeling/ - Обучение и оценка моделей
      - constants.py - Константы обучения (seed, test_size, имена экспериментов)
      - data_split.py - Train/test split
      - train.py - Обучение LogisticRegression + oversampling (только train)
      - evaluation.py - classification_report + confusion matrix + метрики
      - run_experiments.py - CLI-скрипт: запускает baseline/balanced/oversample и сохраняет отчёты
- artifacts/ - Артефакты подготовки данных (генерируются)
- artifacts_model/ - Артефакты обучения (генерируются)
- README.md
- .gitignore
- docs/ — поясняющие документы и выводы
